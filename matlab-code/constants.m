Nx            = 256;
Ny            = 256;
Lx            = 4.0;
Ly            = 4.0;
dx            = Lx/Nx;
dy            = Ly/Ny;
x             = (0:1:Nx-1)*dx-0.5*Lx;
y             = (0:1:Ny-1)*dy-0.5*Ly;
[x,y]         = ndgrid(x,y);
kx            = (0:1:Nx-1);
ky            = (0:1:Ny-1);
kx(Nx/2+2:Nx) = kx(Nx/2+2:Nx)-Nx;
ky(Ny/2+2:Ny) = ky(Ny/2+2:Ny)-Ny;
kx            = kx*(2*pi/Lx);
ky            = ky*(2*pi/Ly);
[kx,ky]       = ndgrid(kx,ky);
k2            = kx.^2+ky.^2;
k2(1,1)       = 1.0E64;